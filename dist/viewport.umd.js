!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.createViewport=t()}(this,function(){"use strict";function e(e,t,n){null!=e&&(e.addEventListener?e.addEventListener(t,n,!1):e.attachEvent("on"+t,function(){return n.call(e,window.event)}))}function t(e,t,n){null!=e&&(e.removeEventListener?e.removeEventListener(t,n):e.detachEvent("on"+t,n))}function n(e,t){if(null!=e)if("function"==typeof Event)e.dispatchEvent(new Event(t));else if(e.document){var n=e.document.createEvent("UIEvents");n.initUIEvent(t,!0,!1,e,0),e.dispatchEvent(n)}}function r(e,t){return null!=e?function(n){var r=e.map(function(e){return t[e]()});return r.unshift(n),r}:function(e){return[e]}}function i(e,t,n){var r=null==e?0:e.length;if(r!==(null==t?0:t.length))return!1;for(var i=void 0!==n?n-1:-1;++i<r;)if(e[i]!==t[i])return!1;return!0}var o=function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)};function u(e,t,n){this.items=null!=e?[].concat(o(e)):[],this.loaded=t||null,this.unloaded=n||null}function s(e,t){var n={};return Object.keys(t).forEach(function(r){n[r]=function(){return t[r](e,e.document)}}),n}u.prototype={get length(){return this.items.length},add:function(e){-1===this.items.indexOf(e)&&(this.items.push(e),this.loaded&&1===this.items.length&&this.loaded(this))},remove:function(e){var t=this.items.indexOf(e);t>-1&&(this.items.splice(t,1),this.unloaded&&!this.items.length&&this.unloaded(this))},empty:function(){this.items=[],this.unloaded&&this.unloaded(this)},forEach:function(e){for(var t=-1,n=this.items.length;++t<n;)if(!1===e(this.items[t],t,this.items))return}};var c={load:{type:["load"]},unload:{type:["beforeunload"]},resize:{type:["resize","scroll","orientationchange"],args:["width","height"]},scroll:{type:["scroll"],args:["scrollX","scrollY"]}},f={width:function(e,t){return e.innerWidth||t.documentElement.clientWidth||t.body.clientWidth},height:function(e,t){return e.innerHeight||t.documentElement.clientHeight||t.body.clientHeight},scrollX:function(e,t){return e.scrollX||e.pageXOffset},scrollY:function(e,t){return e.scrollY||e.pageYOffset}};return function(){var o,l=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window,a=s(l,f),d={},h=(o={addEventListener:e,removeEventListener:t,view:l},function(e,t){var n=[],s=r(e.args,t),c={type:e.type,subscribers:new u(null,function(){return t=(e=c).type,n=e.publisher,void t.forEach(function(e){o.addEventListener(o.view,e,n)});var e,t,n},function(){return t=(e=c).type,n=e.publisher,void t.forEach(function(e){o.removeEventListener(o.view,e,n)});var e,t,n}),publisher:function(e){var t=s(e),r=void 0;if(t.length>1){var o=!i(n,t,1);if(n=t,!o)return!1}return c.subscribers.forEach(function(e){r=e.apply(null,t)}),void 0!==r&&(e.returnValue=r),r},clearCache:function(){return n=[],c}};return c});Object.keys(c).forEach(function(e){d[e]=h(c[e],a)});var v=function(e){if(!d[e])throw new Error("'"+e+"' is not a valid event name");return d[e]},p={on:function(e,t){var n=v(e);return"function"==typeof t&&n.subscribers.add(t),p},off:function(e,t){if(void 0===e)Object.keys(d).forEach(function(e){d[e].subscribers.empty()});else{var n=v(e);"function"==typeof t?n.subscribers.remove(t):void 0===t&&n.subscribers.empty()}return p},trigger:function(e){var t=v(e).clearCache();return n(l,t.type[0]),p}};return Object.keys(a).forEach(function(e){p[e]=a[e]}),p}});
